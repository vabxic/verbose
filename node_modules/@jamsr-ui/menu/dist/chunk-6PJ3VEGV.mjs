"use client"
import{b as g}from"./chunk-275WTEV7.mjs";import{a as w,b as W}from"./chunk-3LXZWE5F.mjs";import{arrow as ge,autoUpdate as ve,flip as Pe,FloatingArrow as he,FloatingFocusManager as be,FloatingList as ye,FloatingNode as Me,FloatingOverlay as Ie,FloatingPortal as Ne,offset as Fe,safePolygon as Oe,shift as Ce,useClick as xe,useDismiss as Re,useFloating as ke,useFloatingNodeId as Ve,useFloatingParentNodeId as Ee,useFloatingTree as we,useHover as We,useInteractions as Se,useListItem as Ae,useListNavigation as Te,useMergeRefs as De,useRole as Le,useTypeahead as He}from"@floating-ui/react";import{useControlledState as Ke}from"@jamsr-ui/hooks";import{ChevronRightIcon as Ue}from"@jamsr-ui/shared-icons";import{useUIConfig as _e}from"@jamsr-ui/config";import{cn as S,dataAttr as v,deepMergeProps as Ge,mapPropsVariants as $e,mergeGlobalProps as qe}from"@jamsr-ui/utils";import{AnimatePresence as ze,m as Be}from"motion/react";import{useEffect as A,useMemo as Je,useRef as P,useState as T}from"react";import{jsx as n,jsxs as h}from"react/jsx-runtime";var Qe={initial:e=>({opacity:0,...e.startsWith("bottom")&&{top:-10},...e.startsWith("top")&&{top:10},...e.startsWith("right")&&{left:-10},...e.startsWith("left")&&{left:10}}),animate:e=>({opacity:1,...e.startsWith("bottom")&&{top:0},...e.startsWith("top")&&{top:0},...e.startsWith("right")&&{left:0},...e.startsWith("left")&&{left:0}}),exit:e=>({opacity:0,...e.startsWith("bottom")&&{top:10},...e.startsWith("top")&&{top:-10},...e.startsWith("right")&&{left:10},...e.startsWith("left")&&{left:-10}})},it=e=>{let{menu:D={},globalConfig:L}=_e(),b=e,H=qe(D,b),K=Ge(H,b,L),[U,_]=$e(K,g.variantKeys),c=Ee(),t=c!=null,{as:Xe,children:G,trigger:$,triggerOn:q="click",placement:y=t?"right-start":"bottom-end",className:M,classNames:a,offset:z=t?2:4,showArrow:B=!1,isOpen:J,initialOpen:Q=!1,onOpenChange:X,openDelay:Y=75,closeDelay:Z=0,closeOnEscapeKey:j=!0,closeOnOutsidePress:ee=!0,lockScroll:te=!0,motionVariants:oe,...I}=U,[o,p]=Ke(Q,J,X),[se,N]=T(!1),[u,d]=T(null),F=P([]),O=P([]),C=P(null),f=W(),s=we(),l=Ve(),x=Ae(),{floatingStyles:ne,refs:R,context:r}=ke({nodeId:l,open:o,onOpenChange:p,placement:y,middleware:[Fe({mainAxis:z,alignmentAxis:t?-4:0}),Pe(),Ce({padding:5}),ge({element:C})],whileElementsMounted:ve}),ae=We(r,{enabled:q==="hover"||t,delay:{open:Y,close:Z},handleClose:Oe({blockPointerEvents:!0})}),re=xe(r,{event:"mousedown",toggle:!t,ignoreMouse:t}),ie=Le(r,{role:"menu"}),le=Re(r,{bubbles:!0,escapeKey:j,outsidePress:ee}),ce=Te(r,{listRef:F,activeIndex:u,nested:t,onNavigate:d}),pe=He(r,{listRef:O,onMatch:o?d:void 0,activeIndex:u}),{getReferenceProps:ue,getFloatingProps:me,getItemProps:k}=Se([ae,re,ie,le,ce,pe]);A(()=>{if(!s)return;function m(){p(!1)}function V(E){E.nodeId!==l&&E.parentId===c&&p(!1)}return s.events.on("click",m),s.events.on("menuopen",V),()=>{s.events.off("click",m),s.events.off("menuopen",V)}},[s,l,c,p]),A(()=>{o&&s&&s.events.emit("menuopen",{parentId:c,nodeId:l})},[s,o,l,c]);let i=g(_),de=Je(()=>({activeIndex:u,setActiveIndex:d,getItemProps:k,setHasFocusInside:N,isOpen:o,classNames:a,styles:i}),[u,a,k,o,i]),fe=o&&se&&t;return h(Me,{id:l,children:[h("div",{ref:De([R.setReference,x.ref]),tabIndex:t?f.activeIndex===x.index?0:-1:void 0,role:t?"menuitem":void 0,...ue(f.getItemProps({...I,onMouseEnter(m){I.onMouseEnter?.(m),N(!1),f.setHasFocusInside(!0)}})),"data-active":v(fe),"data-nested":v(t),"data-open":v(o),className:t?i.menuItem({className:a?.menuItem}):i.base({className:a?.base}),children:[$,t&&n(Ue,{"aria-hidden":!0,className:"ml-auto"})]}),n(w.Provider,{value:de,children:n(ye,{elementsRef:F,labelsRef:O,children:n(ze,{children:o&&n(Ne,{children:n(Ie,{className:i.backdrop({className:a?.backdrop}),"data-slot":"backdrop",lockScroll:te,children:n(be,{context:r,modal:!0,initialFocus:-1,returnFocus:!t,disabled:!0,children:h("div",{ref:R.setFloating,style:ne,className:i.popover({className:S(M,a?.popover)}),...me(),children:[B&&n(he,{ref:C,context:r,className:i.arrow({className:a?.arrow})}),n(Be.ul,{initial:"initial",animate:"animate",exit:"exit",custom:y,variants:oe??Qe,className:i.content({className:S(M,a?.content)}),children:G})]})})})})})})})]})};export{it as a};
