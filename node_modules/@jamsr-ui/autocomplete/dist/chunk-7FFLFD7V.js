"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }"use client"
var _chunkIVTRQZZNjs = require('./chunk-IVTRQZZN.js');var _react = require('@floating-ui/react');var _chip = require('@jamsr-ui/chip');var _config = require('@jamsr-ui/config');var _hooks = require('@jamsr-ui/hooks');var _utils = require('@jamsr-ui/utils');var _react3 = require('react');var _jsxruntime = require('react/jsx-runtime');var pt=se=>{let{autocomplete:le={},globalConfig:re}=_config.useUIConfig.call(void 0, ),T=se,ae=_utils.mergeGlobalProps.call(void 0, le,T),pe=_utils.deepMergeProps.call(void 0, ae,T,re),[ue,I]=_utils.mapPropsVariants.call(void 0, pe,_chunkIVTRQZZNjs.b.variantKeys),d=_react3.useRef.call(void 0, null),{className:V,classNames:f,defaultOpen:ce,defaultValue:ie,isMultiple:o=!1,onOpenChange:me,onValueChange:de,open:fe,placement:D="bottom-start",value:ge,label:O,startContent:w,endContent:S,placeholder:k,helperText:H,isInvalid:G,children:g,inputProps:M,isDisabled:F,onBlur:B,errorMessage:K,onInputValueChange:U}=ue,W=_react3.useRef.call(void 0, null),[he,Ce]=_react3.useState.call(void 0, 1),[x,$]=_react3.useState.call(void 0, !1),[l=[],r]=_hooks.useControlledState.call(void 0, ie,ge,de),c=_react3.Children.toArray(g).map(e=>_react3.isValidElement.call(void 0, e)?{value:e.props.value,children:e.props.children,renderLabel:e.props.renderLabel,label:_nullishCoalesce(e.props.label, () => ((typeof e.props.children=="string"?e.props.children:""))),autocompleteItem:e}:null),h=_react3.useCallback.call(void 0, e=>{if(o){let t=new Set(l);return t.has(e)?(t.delete(e),[...t]):(t.add(e),[...t])}return[e]},[o,l]),C=_react3.useMemo.call(void 0, ()=>{let e=Array.from(l);return o?e.map(t=>{let a=c.find(m=>_optionalChain([m, 'optionalAccess', _2 => _2.value])===t),Oe=_nullishCoalesce(_nullishCoalesce(_optionalChain([a, 'optionalAccess', _3 => _3.renderLabel]), () => (_optionalChain([a, 'optionalAccess', _4 => _4.label]))), () => ((typeof g=="string"?g:_nullishCoalesce(_optionalChain([a, 'optionalAccess', _5 => _5.value]), () => ("")))));return _jsxruntime.jsx.call(void 0, _chip.Chip,{onClick:m=>{m.stopPropagation(),m.nativeEvent.stopPropagation(),m.nativeEvent.stopImmediatePropagation()},onDelete:()=>r(h(t)),children:Oe},t)}):_nullishCoalesce(_optionalChain([c, 'access', _6 => _6.find, 'call', _7 => _7(a=>_optionalChain([a, 'optionalAccess', _8 => _8.value])===e[0]), 'optionalAccess', _9 => _9.label]), () => (""))},[c,g,h,o,r,l]),[_=!1,p]=_hooks.useControlledState.call(void 0, ce,fe,me),[i,P]=_react3.useState.call(void 0, !o&&typeof C=="string"?C:""),Pe=c.filter(e=>_optionalChain([e, 'optionalAccess', _10 => _10.label, 'access', _11 => _11.toLowerCase, 'call', _12 => _12(), 'access', _13 => _13.includes, 'call', _14 => _14(i.toLowerCase())])),N=x?c:Pe,ve=N.map(e=>_nullishCoalesce(_optionalChain([e, 'optionalAccess', _15 => _15.autocompleteItem]), () => (null))),[n,j]=_react3.useState.call(void 0, null),z=_react3.useRef.call(void 0, []),u=_chunkIVTRQZZNjs.b.call(void 0, {className:V,...I}),q=_react3.useCallback.call(void 0, e=>{P(e),_optionalChain([U, 'optionalCall', _16 => _16(e)]),p(!0),$(!1),j(0)},[U,p]),E=_react3.useCallback.call(void 0, ()=>{$(!0),p(e=>!e)},[p]),{refs:{setReference:J,setFloating:be},floatingStyles:ye,context:v}=_react.useFloating.call(void 0, {placement:D,open:_,onOpenChange:E,whileElementsMounted:_react.autoUpdate,middleware:[_react.offset.call(void 0, 2),_react.flip.call(void 0, {crossAxis:D.includes("-"),padding:0}),_react.size.call(void 0, {apply({rects:e,elements:t,availableHeight:a}){Object.assign(t.floating.style,{maxHeight:`${Math.max(50,Math.min(400,a))}px`,width:`${e.reference.width}px`})},padding:0})]}),Ie=_react.useListNavigation.call(void 0, v,{listRef:z,activeIndex:n,selectedIndex:he,onNavigate:j,virtual:!0,loop:!0}),Me=_react.useDismiss.call(void 0, v,{outsidePress:e=>{let t=e.target;return!(_optionalChain([W, 'access', _17 => _17.current, 'optionalAccess', _18 => _18.contains, 'call', _19 => _19(t)])&&_optionalChain([t, 'optionalAccess', _20 => _20.dataset, 'access', _21 => _21.slot])==="label")}}),xe=_react.useRole.call(void 0, v,{role:"listbox"}),{getReferenceProps:Q,getFloatingProps:Ne,getItemProps:X}=_react.useInteractions.call(void 0, [Ie,Me,xe]),b=_react3.useCallback.call(void 0, e=>{x&&n!==null&&Ce(n),o||(P(e.label),p(!1)),o&&(P(""),_optionalChain([d, 'access', _22 => _22.current, 'optionalAccess', _23 => _23.focus, 'call', _24 => _24()])),r(h(e.value))},[n,h,x,o,p,r]),Y=_react3.useCallback.call(void 0, ()=>{_optionalChain([d, 'access', _25 => _25.current, 'optionalAccess', _26 => _26.focus, 'call', _27 => _27()])},[]),Ee=_react3.useCallback.call(void 0, e=>{e.preventDefault()},[]),Re=_react3.useMemo.call(void 0, ()=>({activeIndex:n,getItemProps:X,handleSelect:b,setValue:r,isMultiple:o,value:l,setInputValue:P,styles:u,focusInput:Y}),[n,X,b,o,r,u,l,Y]),Z=_react3.useCallback.call(void 0, e=>{if(e.key==="Enter"&&n!==null){e.preventDefault();let t=N[n];if(!t)return;b({label:t.label,value:t.value})}},[n,b,N]),Ae=e=>({"data-component":"autocomplete","data-slot":"base",className:u.base({className:_utils.cn.call(void 0, _optionalChain([f, 'optionalAccess', _28 => _28.base]),V)}),ref:W,...e}),Le=e=>({"data-slot":"popover",ref:be,style:ye,className:u.popover({className:_optionalChain([f, 'optionalAccess', _29 => _29.popover])}),...Ne(),...e}),Te=e=>({"data-slot":"content",className:u.content({className:_optionalChain([f, 'optionalAccess', _30 => _30.content])}),onMouseDown:Ee,...e}),Ve=e=>({"data-slot":"empty-content",className:u.emptyContent({className:_optionalChain([f, 'optionalAccess', _31 => _31.emptyContent])}),...e}),ee=_react3.useCallback.call(void 0, e=>{e.stopPropagation(),_optionalChain([d, 'access', _32 => _32.current, 'optionalAccess', _33 => _33.focus, 'call', _34 => _34()]),r([])},[r]),te=_react3.useMemo.call(void 0, ()=>o?l.length>0:i.length>0,[i.length,o,l.length]),De=_react3.useCallback.call(void 0, ()=>({label:O,startContent:w,endContent:S,placeholder:k,helperText:H,errorMessage:K,isInvalid:G,radius:I.radius,...M,"data-slot":"input",value:i,onValueChange:q,type:"search",autoComplete:"off",children:o?C:null,inputWrapperRef:J,classNames:{..._optionalChain([M, 'optionalAccess', _35 => _35.classNames]),inputWrapper:"select-none",contentWrapper:_utils.cn.call(void 0, "h-auto flex-wrap gap-1",{"p-1":o})},isClearable:!0,onClearInput:ee,showClearButton:te,slotProps:{inputWrapper:{onClick:E}},isDisabled:F,onBlur:B,...Q({onKeyDown:Z,ref:d})}),[S,K,Q,q,Z,E,te,H,M,i,F,G,o,O,B,ee,k,C,J,w,I.radius]);return{context:v,elementsRef:z,isOpen:_,getBaseProps:Ae,getInputProps:De,getPopoverProps:Le,getContentProps:Te,contextValue:Re,childrenToRender:ve,getEmptyContentProps:Ve}};exports.a = pt;
