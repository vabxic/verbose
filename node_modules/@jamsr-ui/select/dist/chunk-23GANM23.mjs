"use client"
import{b as h}from"./chunk-6FFTWWZT.mjs";import{autoUpdate as Ee,flip as Le,offset as Ue,size as Oe,useClick as Fe,useDismiss as He,useFloating as We,useInteractions as $e,useListNavigation as je,useRole as ke,useTypeahead as Be}from"@floating-ui/react";import{useUIConfig as ze}from"@jamsr-ui/config";import{useControlledState as H,useHover as Ke,useIsDisabled as qe,useMergeRefs as Je}from"@jamsr-ui/hooks";import{cn as W,dataAttr as p,deepMergeProps as Qe,formLabelProps as Xe,mapPropsVariants as Ye,mergeGlobalProps as Ze}from"@jamsr-ui/utils";import{Children as _e,isValidElement as et,useCallback as v,useId as tt,useMemo as C,useRef as N,useState as $}from"react";var yt=j=>{let{select:k={},globalConfig:B}=ze(),S=j,z=Ze(k,S),K=Qe(z,S,B),[q,V]=Ye(K,h.variantKeys),{label:J,children:y,onValueChange:Q,defaultValue:X,value:Y,placeholder:Z="Select",className:R,classNames:t,onOpenChange:_,defaultOpen:ee,open:te,isMultiple:a=!1,helperText:oe,renderValue:g,placement:I="bottom-start",startContent:se,endContent:re,as:ae,isDisabled:ne=!1,returnFocus:le=!0,isFormControl:pe=!1,disableTypeahead:x=!1,onUncontrolledValueChange:M,topContent:ce,bottomContent:ie,errorMessage:de,...ue}=q,me=ae??"div",[r=[],i]=H(X,Y,Q),[d,P]=H(ee,te,_),T=tt(),G=N(null),{isDisabled:n,ref:ge}=qe({isDisabled:ne,isFormControl:pe}),{isHovered:Pe,ref:fe}=Ke({isDisabled:n}),w=_e.toArray(y).map(e=>et(e)?{value:e.props.value,children:e.props.children,label:e.props.label}:null),A=C(()=>{let e=w.filter(s=>s&&new Set(r).has(s.value)).map(s=>s?.label??(typeof s?.children=="string"?s.children:s?.value??""));return new Set(e)},[w,r]),[u,D]=$(null),[m,be]=$(null),E=N([]),L=N([]),o=h({...V,className:R}),{refs:{setReference:he,setFloating:ve},floatingStyles:Ce,context:l}=We({placement:I,open:d,onOpenChange:P,whileElementsMounted:Ee,middleware:[Ue(2),Le({crossAxis:I.includes("-"),padding:0}),Oe({apply({rects:e,elements:s,availableHeight:b}){Object.assign(s.floating.style,{height:`${e.floating.height}px`,maxHeight:`${Math.max(50,Math.min(e.floating.height,400,b))}px`,width:`${e.reference.width}px`})},padding:0})]}),Ne=Je([fe,ge,he]),f=v(e=>{be(e),e!==null&&(a||P(!1))},[a,P]);function Se(e){d?D(e):f(e)}let Ve=je(l,{listRef:E,activeIndex:u,selectedIndex:m,onNavigate:D,loop:!0,virtual:x===!0}),ye=Be(l,{listRef:L,activeIndex:u,selectedIndex:m,onMatch:Se,enabled:!x}),Re=Fe(l),Ie=He(l,{outsidePress:e=>{let s=e.target;return!(G.current?.contains(s)&&s?.dataset.slot==="label")}}),xe=ke(l,{role:"listbox"}),{getReferenceProps:Me,getFloatingProps:Te,getItemProps:U}=$e([Ve,ye,Re,Ie,xe]),O=v(e=>{let s=r,F=(()=>{if(!a)return[e];let c=new Set(s);return c.has(e)?(c.delete(e),[...c]):(c.add(e),[...c])})();M?.(F),i(F)},[a,M,i,r]),Ge=C(()=>({activeIndex:u,selectedIndex:m,getItemProps:U,handleSelect:f,setValue:i,isMultiple:a,value:r,styles:o,classNames:t,onSelectValue:O}),[u,t,U,f,a,O,m,i,o,r]),we=r.length>0,Ae=C(()=>g?g(Array.from(r)):Array.from(A).join(","),[g,A,r]),De=v(e=>{e.preventDefault()},[]);return{Component:me,returnFocus:le,context:l,elementsRef:E,labelsRef:L,isOpen:d,hasValue:we,label:J,placeholder:Z,helperText:oe,children:y,getRenderValue:Ae,getBaseProps:e=>({"data-component":"select","data-slot":"base","data-open":p(d),"data-hovered":p(Pe),"data-disabled":p(n),"aria-disabled":p(n),...e,className:o.base({className:W(t?.base,R)}),ref:G,...ue}),getLabelProps:e=>({"data-slot":"label",className:o.label({className:t?.label}),htmlFor:T,...Xe(),...e}),getMainWrapperProps:e=>({"data-slot":"main-wrapper",className:o.mainWrapper({className:t?.mainWrapper}),...e}),getInnerWrapperProps:e=>({"data-slot":"inner-wrapper",className:o.innerWrapper({className:t?.innerWrapper}),...e}),getTriggerProps:e=>({"data-slot":"trigger",type:"button",id:T,className:o.trigger({className:W(t?.trigger,{"h-auto":a})}),disabled:n,"aria-disabled":p(n),"data-disabled":p(n),...e,...Me({ref:Ne})}),getValueProps:e=>({"data-slot":"value",className:o.value({className:t?.value}),...e}),getPlaceholderProps:e=>({"data-slot":"placeholder",className:o.placeholder({className:t?.placeholder}),...e}),getPopoverProps:e=>({"data-slot":"popover",ref:ve,style:Ce,className:o.popover({className:t?.popover}),...Te(),...e}),getContentProps:e=>({"data-slot":"content",className:o.content({className:t?.content}),onMouseDown:De,...e}),getHelperTextProps:e=>({"data-slot":"helper-text",className:o.helperText({className:t?.helperText}),...e}),getStartContentProps:e=>({"data-slot":"start-content",className:o.startContent({className:t?.startContent}),...e}),getEndContentProps:e=>({"data-slot":"end-content",className:o.endContent({className:t?.endContent}),...e}),getIndicatorProps:e=>({"data-slot":"indicator",className:o.indicator({className:t?.indicator}),...e}),getScrollAreaProps:e=>({"data-slot":"scroll-area",className:o.scrollArea({className:t?.scrollArea}),...e}),contextValue:Ge,startContent:se,endContent:re,topContent:ce,bottomContent:ie,getErrorMessageProps:e=>({"data-slot":"error-message",className:o.errorMessage({className:t?.errorMessage}),...e}),isInvalid:V.isInvalid,errorMessage:de}};export{yt as a};
