"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }"use client"
var _chunkFUVMXHAQjs = require('./chunk-FUVMXHAQ.js');var _config = require('@jamsr-ui/config');var _hooks = require('@jamsr-ui/hooks');var _sharedicons = require('@jamsr-ui/shared-icons');var _utils = require('@jamsr-ui/utils');var _react = require('react');var _reactdropzone = require('react-dropzone');var _jsxruntime = require('react/jsx-runtime');var Te=w=>{let{fileUploadMulti:L={},globalConfig:O}=_config.useUIConfig.call(void 0, ),F=w,T=_utils.mergeGlobalProps.call(void 0, L,F),V=_utils.deepMergeProps.call(void 0, T,F,O),[G,R]=_utils.mapPropsVariants.call(void 0, V,_chunkFUVMXHAQjs.b.variantKeys),{defaultValue:A,value:k,className:N,classNames:o={},onFilesSelect:h,onValueChange:B,onError:d,showDeleteBtn:W=!0,dropzoneOptions:C={},onDelete:_,helperText:H,info:j,uploadIcon:z=_jsxruntime.jsx.call(void 0, _sharedicons.FileAddIcon,{className:"shrink-0 text-inherit"}),as:X,inputName:M,uploadApiUrl:D,onUploadSuccess:I,getFileUrlAfterUpload:y,label:$,isFormControl:q=!1,...E}=G,[p,m]=_hooks.useControlledState2.call(void 0, _nullishCoalesce(A, () => ([])),k,B),{isDisabled:J=!1}=R,{isDisabled:c,ref:K}=_hooks.useIsDisabled.call(void 0, {isDisabled:J,isFormControl:q}),g=_react.useRef.call(void 0, []),Y=_nullishCoalesce(X, () => ("div")),{maxFiles:u=5}=C,Q=p.length<u,f=_react.useCallback.call(void 0, (e,r)=>{m(a=>a.map(t=>t.id===e?{...t,...r}:t))},[m]),U=_react.useCallback.call(void 0, (e,r)=>{let a=new FormData;a.append(M,r);let t=new XMLHttpRequest;g.current.push({id:e,xhr:t}),t.open("POST",D),t.upload.onprogress=l=>{if(l.lengthComputable){let P=Math.round(l.loaded/l.total*100);f(e,{progress:P})}},t.onload=()=>{if(t.status===200){let l=JSON.parse(t.responseText),P=y(l),S=p.find(Pe=>Pe.id===e);_optionalChain([S, 'optionalAccess', _2 => _2.preview])&&URL.revokeObjectURL(S.preview),f(e,{progress:"COMPLETE",file:null,preview:P}),_optionalChain([I, 'optionalCall', _3 => _3({id:e,response:l})])}else f(e,{progress:"ERROR"}),_optionalChain([d, 'optionalCall', _4 => _4({message:"Invalid response received",code:"INVALID_RESPONSE"})])},t.onerror=()=>{f(e,{progress:"ERROR"}),_optionalChain([d, 'optionalCall', _5 => _5({message:"Upload failed",code:"UPLOAD_FAILED"})])},t.send(a)},[y,M,d,I,f,D,p]),Z=e=>{let r=p.find(a=>a.id===e);_optionalChain([r, 'optionalAccess', _6 => _6.file])&&U(e,r.file)},ee=e=>{_optionalChain([g, 'access', _7 => _7.current, 'access', _8 => _8.find, 'call', _9 => _9(a=>a.id===e), 'optionalAccess', _10 => _10.xhr, 'optionalAccess', _11 => _11.abort, 'call', _12 => _12()]),g.current=g.current.filter(a=>a.id!==e)},te=_react.useCallback.call(void 0, e=>{let r=e,a=u-p.length;if(u&&r.length>a){let l=`You can only upload ${u} files. Remaining ${a}`;_optionalChain([d, 'optionalCall', _13 => _13({message:l,code:"MAXIMUM_LIMIT_REACHED"})]);return}let t=r.map(l=>({preview:URL.createObjectURL(l),file:l,id:_utils.randomId.call(void 0, ),progress:"PENDING"}));m(l=>[...l,...t]),t.forEach(l=>{l.file&&U(l.id,l.file)}),_optionalChain([h, 'optionalCall', _14 => _14(r)])},[u,d,h,m,U,p]),{getRootProps:oe,getInputProps:se,isDragActive:b}=_reactdropzone.useDropzone.call(void 0, {maxFiles:u,multiple:!0,disabled:c,onDrop:te,onDropRejected(e){e.forEach(r=>{let{errors:a}=r,t=a[0];t&&_optionalChain([d, 'optionalCall', _15 => _15(t)])})},...C}),s=_chunkFUVMXHAQjs.b.call(void 0, {...R,isDisabled:c,isDragActive:b,className:N}),re=s.overlayWrapper({className:o.overlayWrapper}),ae=s.overlay({className:o.overlay}),le=(e,r)=>{_optionalChain([_, 'optionalCall', _16 => _16(r)]),ee(r),e.stopPropagation(),m(a=>a.filter(t=>t.id!==r))},ne=_react.useCallback.call(void 0, e=>({"data-component":"file-upload","data-slot":"base","data-drag-active":_utils.dataAttr.call(void 0, b),"data-disabled":_utils.dataAttr.call(void 0, c),...e,className:s.base({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _17 => _17.base]),N)}),...E}),[N,_optionalChain([o, 'optionalAccess', _18 => _18.base]),c,b,s,E]),ie=e=>({"data-slot":"label",className:s.label({className:_optionalChain([o, 'optionalAccess', _19 => _19.label])}),...e}),pe=_react.useCallback.call(void 0, e=>({"data-slot":"file-view",className:s.fileView({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _20 => _20.fileView]),_optionalChain([e, 'optionalAccess', _21 => _21.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _22 => _22.fileView]),s]),ce=_react.useCallback.call(void 0, e=>({"data-slot":"file",className:s.file({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _23 => _23.file]),_optionalChain([e, 'optionalAccess', _24 => _24.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _25 => _25.file]),s]),de=_react.useCallback.call(void 0, e=>({"data-slot":"delete-btn","aria-label":"delete",type:"button",disabled:c,className:s.deleteBtn({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _26 => _26.deleteBtn]),_optionalChain([e, 'optionalAccess', _27 => _27.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _28 => _28.deleteBtn]),c,s]),me=_react.useCallback.call(void 0, e=>({"data-slot":"picker",className:s.picker({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _29 => _29.picker]),_optionalChain([e, 'optionalAccess', _30 => _30.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _31 => _31.picker]),s]),ue=_react.useCallback.call(void 0, e=>({"data-slot":"helper-text",className:s.helperText({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _32 => _32.helperText]),_optionalChain([e, 'optionalAccess', _33 => _33.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _34 => _34.helperText]),s]),fe=_react.useCallback.call(void 0, e=>({"data-slot":"inner-wrapper",className:s.innerWrapper({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _35 => _35.innerWrapper]),_optionalChain([e, 'optionalAccess', _36 => _36.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _37 => _37.innerWrapper]),s]),ge=_react.useCallback.call(void 0, e=>({"data-slot":"info",className:s.info({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _38 => _38.info]),_optionalChain([e, 'optionalAccess', _39 => _39.className]))}),...e}),[_optionalChain([o, 'optionalAccess', _40 => _40.info]),s]);return{Component:Y,getRootProps:oe,getInputProps:se,getBaseProps:ne,getFileViewProps:pe,getFileProps:ce,getDeleteBtnProps:de,getPickerProps:me,handleDelete:le,value:p,setValue:m,showDeleteBtn:W,isDisabled:c,canUploadFile:Q,helperText:H,getHelperTextProps:ue,getInnerWrapperProps:fe,info:j,getInfoProps:ge,uploadIcon:z,retryUpload:Z,overlayWrapperClassName:re,overlayClassName:ae,label:$,getLabelProps:ie,inputRef:K}};exports.a = Te;
