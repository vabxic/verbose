"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }"use client"
var _chunkMZ2UGN35js = require('./chunk-MZ2UGN35.js');var _chunkDRN74CRWjs = require('./chunk-DRN74CRW.js');var _hooks = require('@jamsr-ui/hooks');var _sharedicons = require('@jamsr-ui/shared-icons');var _config = require('@jamsr-ui/config');var _utils = require('@jamsr-ui/utils');var _react = require('react');var _reactdropzone = require('react-dropzone');var _jsxruntime = require('react/jsx-runtime');var so=W=>{let{fileUploadSingle:j={},globalConfig:_}=_config.useUIConfig.call(void 0, ),h=W,$=_utils.mergeGlobalProps.call(void 0, j,h),q=_utils.deepMergeProps.call(void 0, $,h,_),[X,U]=_utils.mapPropsVariants.call(void 0, q,_chunkMZ2UGN35js.b.variantKeys),{value:J,defaultValue:K,onValueChange:Q,onFileSelect:y,className:x,classNames:o,onError:F,onDelete:z,showDeleteBtn:Y=!0,description:Z="Choose a file or drag & drop it here",info:ee="Select images",dropzoneOptions:oe,fileSize:te,fileName:se,helperText:re,uploadIcon:ae=_jsxruntime.jsx.call(void 0, _sharedicons.FileAddIcon,{className:"shrink-0 text-inherit"}),getFileIcon:C,as:le,inputName:E,uploadApiUrl:G,onUploadSuccess:T,getFileUrlAfterUpload:w,label:ne,isFormControl:pe=!1,...L}=X,m=_react.useRef.call(void 0, null),[a=null,u]=_hooks.useControlledState.call(void 0, K,J,Q),{isDisabled:ie=!1}=U,{isDisabled:d,ref:ce}=_hooks.useIsDisabled.call(void 0, {isDisabled:ie,isFormControl:pe}),[n,f]=_react.useState.call(void 0, a),[de,g]=_react.useState.call(void 0, 0),[me,P]=_react.useState.call(void 0, !1),[i,k]=_react.useState.call(void 0, null),ue=i?i.name:se,fe=i?i.size:te,ge=a&&_chunkDRN74CRWjs.b.call(void 0, a),Pe=_nullishCoalesce(le, () => ("div")),Ne=!n,ve=_react.useMemo.call(void 0, ()=>a?C?_optionalChain([C, 'optionalCall', _2 => _2(_chunkDRN74CRWjs.a.call(void 0, a))]):_chunkDRN74CRWjs.c.call(void 0, a):"",[C,a]),c=_react.useCallback.call(void 0, ()=>{_optionalChain([n, 'optionalAccess', _3 => _3.startsWith, 'call', _4 => _4("blob:")])&&URL.revokeObjectURL(n)},[n]);_react.useEffect.call(void 0, ()=>{a!==n&&f(a)},[n,a]);let N=_react.useCallback.call(void 0, ()=>{u(null),f(null),g(0),k(null),P(!1),c()},[c,u]),A=_react.useCallback.call(void 0, e=>{g(0),P(!1),m.current=null,c(),u(e),f(e)},[c,u]),S=_react.useCallback.call(void 0, ()=>{g(0),P(!0),_optionalChain([F, 'optionalCall', _5 => _5({message:"Invalid response received",code:"INVALID_RESPONSE"})])},[F]),M=_react.useCallback.call(void 0, e=>{e.stopPropagation(),_optionalChain([z, 'optionalCall', _6 => _6()]),N(),m.current&&m.current.abort()},[z,N]),v=_react.useCallback.call(void 0, e=>{let l=new FormData;l.append(E,e);let r=new XMLHttpRequest;m.current=r,r.open("POST",G),r.upload.onprogress=p=>{if(p.lengthComputable){let D=Math.round(p.loaded/p.total*100);g(D)}},r.onload=()=>{if(r.status===200){let p=JSON.parse(r.responseText),D=w(p);A(D),_optionalChain([T, 'optionalCall', _7 => _7(p)])}else S()},r.onerror=()=>{S()},r.onabort=()=>{N()},r.send(l)},[w,E,A,S,T,N,G]),be=_react.useCallback.call(void 0, e=>{e.preventDefault(),e.stopPropagation(),i&&v(i),P(!1)},[i,v]),Ue=_react.useCallback.call(void 0, e=>{let l=e[0];if(!l)return;k(l),c();let r=URL.createObjectURL(l);f(r),v(l),_optionalChain([y, 'optionalCall', _8 => _8(l)])},[y,c,v]),{getRootProps:Fe,getInputProps:Ce,isDragActive:R}=_reactdropzone.useDropzone.call(void 0, {...oe,maxFiles:1,multiple:!1,disabled:d,onDrop:Ue,onDropRejected(e){e.forEach(l=>{let{errors:r}=l,p=r[0];p&&_optionalChain([F, 'optionalCall', _9 => _9(p)])})}}),t=_chunkMZ2UGN35js.b.call(void 0, {...U,isDisabled:d,isDragActive:R}),Se=_react.useCallback.call(void 0, (e={})=>({"data-component":"file-upload","data-slot":"base","data-drag-active":_utils.dataAttr.call(void 0, R),"data-disabled":_utils.dataAttr.call(void 0, d),...e,...L,className:t.base({className:_utils.cn.call(void 0, _optionalChain([o, 'optionalAccess', _10 => _10.base]),x)})}),[x,_optionalChain([o, 'optionalAccess', _11 => _11.base]),d,R,L,t]),Re=e=>({"data-slot":"label",...e,className:t.label({className:_optionalChain([o, 'optionalAccess', _12 => _12.label])})}),De=_react.useCallback.call(void 0, (e={})=>({"data-slot":"wrapper",...e,className:t.wrapper({className:_optionalChain([o, 'optionalAccess', _13 => _13.wrapper])})}),[_optionalChain([o, 'optionalAccess', _14 => _14.wrapper]),t]),Ie=_react.useCallback.call(void 0, (e={})=>({"data-slot":"delete-btn",...e,onClick:M,className:t.deleteBtn({className:_optionalChain([o, 'optionalAccess', _15 => _15.deleteBtn])})}),[_optionalChain([o, 'optionalAccess', _16 => _16.deleteBtn]),M,t]),he=_react.useCallback.call(void 0, (e={})=>({"data-slot":"picker",...e,className:t.picker({className:_optionalChain([o, 'optionalAccess', _17 => _17.picker])})}),[_optionalChain([o, 'optionalAccess', _18 => _18.picker]),t]),ye=_react.useCallback.call(void 0, (e={})=>({"data-slot":"progress-overlay",...e,className:t.overlay({className:_optionalChain([o, 'optionalAccess', _19 => _19.overlay])})}),[_optionalChain([o, 'optionalAccess', _20 => _20.overlay]),t]),xe=_react.useCallback.call(void 0, (e={})=>({"data-slot":"helper-text",...e,className:t.helperText({className:_optionalChain([o, 'optionalAccess', _21 => _21.helperText])})}),[_optionalChain([o, 'optionalAccess', _22 => _22.helperText]),t]),ze=_react.useCallback.call(void 0, (e={})=>({"data-slot":"file-wrapper",...e,className:t.fileWrapper({className:_optionalChain([o, 'optionalAccess', _23 => _23.fileWrapper])})}),[_optionalChain([o, 'optionalAccess', _24 => _24.fileWrapper]),t]),Ee=_react.useCallback.call(void 0, (e={})=>({"data-slot":"info",...e,className:t.info({className:_optionalChain([o, 'optionalAccess', _25 => _25.info])})}),[_optionalChain([o, 'optionalAccess', _26 => _26.info]),t]),Ge=_react.useCallback.call(void 0, (e={})=>({"data-slot":"description",...e,className:t.description({className:_optionalChain([o, 'optionalAccess', _27 => _27.description])})}),[_optionalChain([o, 'optionalAccess', _28 => _28.description]),t]),Te=_react.useCallback.call(void 0, (e={})=>({"data-slot":"image",...e,src:_nullishCoalesce(n, () => (void 0)),className:t.image({className:_optionalChain([o, 'optionalAccess', _29 => _29.image])})}),[_optionalChain([o, 'optionalAccess', _30 => _30.image]),n,t]),we=_react.useCallback.call(void 0, (e={})=>({"data-slot":"file-name",...e,className:t.fileName({className:_optionalChain([o, 'optionalAccess', _31 => _31.fileName])})}),[_optionalChain([o, 'optionalAccess', _32 => _32.fileName]),t]),Le=_react.useCallback.call(void 0, (e={})=>({"data-slot":"file-size",...e,className:t.fileSize({className:_optionalChain([o, 'optionalAccess', _33 => _33.fileSize])})}),[_optionalChain([o, 'optionalAccess', _34 => _34.fileSize]),t]);return{getBaseProps:Se,getRootProps:Fe,getInputProps:Ce,getLabelProps:Re,getDeleteBtnProps:Ie,getPickerProps:he,getOverlayProps:ye,getHelperTextProps:xe,getFileWrapperProps:ze,getInfoProps:Ee,getDescriptionProps:Ge,getImageProps:Te,Component:Pe,uploadIcon:ae,isAvatar:U.isAvatar,description:Z,info:ee,previewUrl:n,isImage:ge,getFileNameProps:we,getFileSizeProps:Le,fileName:ue,fileSize:fe,fileIcon:ve,showDeleteBtn:Y,isDisabled:d,progress:de,helperText:re,isEmpty:Ne,isFailed:me,onRetry:be,label:ne,inputRef:ce,getWrapperProps:De}};exports.a = so;
